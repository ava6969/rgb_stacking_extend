import numpy as np
import torch


m = torch.load('/home/dewe/sam/log/TSLA_CummReturnStop_ALL_10M_LogRet_SMall7_NoCloseGRay_LRDecay/policy.pt')

t = torch.tensor([[255, 255, 255, 255, 253, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
 255, 255, 255, 255, 238, 255, 255, 255, 255, 255, 255, 255, 253, 255, 255, 255, 255, 255, 255, 255, 253, 255, 255, 255, 255, 255, 255, 255, 253, 255, 255, 255,
 255, 255, 255, 255, 238, 255, 255, 255, 255, 255, 255, 255, 253, 255, 255, 255, 255, 255, 255, 255, 253, 255, 255, 255, 255, 255, 255, 255, 253, 255, 255, 255,
 255, 255, 255, 255, 238, 255, 255, 239, 255, 255, 255, 255, 253, 255, 255, 255, 255, 255, 255, 255, 253, 255, 255, 255, 255, 255, 255, 255, 253, 255, 255, 255,
 254, 253, 253, 253, 237, 253, 253, 238, 253, 253, 253, 253, 252, 253, 253, 253, 253, 253, 253, 253, 252, 253, 253, 253, 253, 253, 253, 253, 252, 253, 253, 255,
 255, 255, 255, 239, 180, 198, 227, 196, 227, 255, 255, 255, 253, 255, 255, 255, 255, 255, 255, 255, 253, 255, 255, 255, 255, 255, 255, 255, 253, 255, 255, 255,
 239,  54,  57, 211, 105, 133, 163,  53, 130, 255, 255, 255, 253, 255, 255, 255, 255, 255, 255, 255, 253, 255, 255, 255, 255, 255, 255, 255, 253, 255, 255, 255,
 239,  56,  57, 200, 109, 133, 180,  87, 149, 255, 255, 255, 253, 255, 255, 255, 255, 255, 255, 255, 253, 255, 255, 255, 255, 255, 255, 255, 253, 255, 255, 255,
 240,  70,  72, 202, 109, 132, 253, 246, 239, 140,  74, 175, 252, 253, 253, 253, 253, 253, 253, 253, 252, 253, 253, 253, 253, 253, 253, 253, 252, 253, 253, 255,
 255, 239, 241, 241, 193, 214, 255, 255, 254, 117,  56, 167, 253, 255, 255, 255, 255, 255, 254, 255, 253, 255, 255, 255, 255, 255, 255, 255, 253, 255, 255, 255,
 255, 238, 250, 255, 241, 255, 255, 255, 255, 126,  55, 167, 253, 247, 255, 255, 253, 255, 239, 255, 253, 253, 255, 255, 255, 255, 255, 255, 253, 255, 255, 255,
 255, 239, 255, 255, 253, 255, 255, 255, 255, 127,  53, 167, 133, 109, 215, 255, 239, 255, 239, 255, 183,  63, 121, 255, 252, 255, 255, 255, 253, 255, 255, 255,
 255, 239, 255, 255, 253, 255, 255, 255, 255, 246, 224, 235, 184, 164, 232,  67,  66, 225, 161, 177, 178,  56, 115, 255, 239, 255, 255, 255, 253, 255, 255, 255,
 254, 242, 253, 253, 252, 253, 253, 253, 253, 253, 238, 253, 239, 225, 239,  52,  53, 197, 104, 120, 177,  56, 115, 253, 237, 253, 253, 253, 252, 253, 253, 255,
 255, 255, 255, 255, 253, 255, 255, 255, 255, 255, 244, 255, 253, 239, 255, 117, 112, 213, 109, 116, 177,  56, 115, 255, 239, 255, 255, 255, 253, 255, 255, 255,
 255, 255, 255, 255, 253, 255, 255, 255, 255, 255, 255, 255, 253, 239, 255, 255, 239, 242, 184, 200, 170,  55, 115, 255, 239, 255, 255, 255, 253, 255, 255, 255,
 255, 255, 255, 255, 253, 255, 255, 255, 255, 255, 255, 255, 253, 242, 255, 255, 248, 255, 242, 255, 178,  54, 110, 254, 239, 255, 255, 255, 253, 255, 255, 255,
 254, 246, 244, 246, 244, 244, 246, 246, 244, 246, 246, 244, 244, 246, 244, 246, 246, 244, 246, 246, 171,  54, 111, 230, 217, 244, 244, 235, 244, 190, 178, 250,
 254, 253, 253, 253, 252, 253, 253, 253, 253, 253, 253, 253, 252, 253, 253, 253, 253, 253, 253, 253, 178,  56, 115, 223, 185, 212, 252, 237, 252, 115, 109, 246,
 255, 255, 255, 255, 253, 255, 255, 255, 255, 255, 255, 255, 253, 255, 255, 255, 255, 255, 255, 255, 245, 217, 238, 143,  56, 152, 242, 238, 253, 115, 109, 246,
 254, 249, 249, 249, 247, 249, 249, 249, 249, 249, 249, 249, 247, 249, 249, 249, 249, 249, 249, 249, 247, 249, 249, 199, 151, 203, 148, 109, 192, 174, 174, 250,
 255, 255, 255, 255, 253, 255, 255, 255, 255, 255, 255, 255, 253, 255, 255, 255, 255, 255, 255, 255, 253, 255, 255, 255, 239, 255, 255, 239, 253, 255, 239, 255,
 255, 255, 255, 255, 253, 255, 255, 255, 255, 255, 255, 255, 253, 255, 255, 255, 255, 255, 255, 255, 253, 255, 255, 255, 253, 255, 255, 248, 253, 255, 239, 255,
 254, 253, 253, 253, 252, 253, 253, 253, 253, 253, 253, 253, 252, 253, 253, 253, 253, 253, 253, 253, 252, 253, 253, 253, 253, 253, 253, 253, 252, 253, 237, 255,
 255, 255, 255, 255, 254, 255, 255, 255, 255, 255, 255, 255, 254, 255, 255, 255, 255, 255, 255, 255, 254, 255, 255, 255, 255, 255, 255, 255, 254, 255, 245, 255,
 248, 255, 255, 247, 211, 232, 255, 255, 255, 247, 240, 252, 254, 255, 255, 255, 255, 255, 255, 255, 254, 255, 255, 255, 255, 255, 255, 255, 254, 255, 255, 255,
 241, 155, 190, 233, 148, 199, 241, 219, 241, 184, 117, 226, 205, 181, 250, 253, 253, 253, 253, 253, 250, 236, 244, 223, 150, 211, 253, 253, 252, 250, 249, 254,
 242, 117, 161, 233, 148, 199, 206, 117, 205, 184, 117, 226, 183, 148, 249, 253, 253, 253, 253, 253, 234, 117, 176, 213, 117, 197, 241, 226, 246, 188, 148, 248,
 242, 117, 161, 233, 148, 199, 206, 117, 205, 184, 117, 226, 183, 148, 249, 240, 240, 253, 154, 180, 234, 117, 176, 213, 117, 197, 206, 148, 225, 188, 148, 248,
 242, 117, 161, 233, 148, 199, 206, 117, 205, 184, 117, 226, 183, 148, 249, 141, 133, 253, 150, 177, 234, 117, 176, 213, 117, 197, 206, 148, 226, 188, 148, 248,
 242, 117, 161, 233, 145, 199, 206, 117, 205, 184, 117, 226, 180, 148, 249, 141, 133, 253, 150, 177, 229, 117, 176, 213, 117, 197, 206, 148, 221, 188, 148, 248,
 254, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 239, 253]])

print(m.shared_feature_extarct.forward(t) )